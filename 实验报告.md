<center>Web 框架编程 期中作业实验报告</center>

姓名：来轩羽

学号：20020007028

专业：计算机科学与技术20

项目地址：https://github.com/jianzhis11/ouc-2022-Web



### 一、题目

<center>基于SSM的学生选课系统</center>

### 二、设计要求

1、考察 Spring 及 MyBatis 知识掌握程度，以及框架整合能力

2、Spring：要求通过 Spring 容器管理类

3、MyBatis：深刻理解 ORM 思想并运用 MyBatis 框架操作数据库

4、MySQL：数据库系统及基本 SQL 语句的使用

5、学习掌握网站系统开发的流程和技术

### 三、主要内容

具有学生、教师、管理员角色，并实现如下基础功能：

- 学生管理：学生的增删改查
- 课程管理：课程的增删改查
- 教师管理：教师的增删改查，一名教师可以教授 1 ~ n 门课程
- 选课管理：选课的增删改查，每位学生可以选择 1 ~ n 门课程

### 四、背景

​		本系统是采用 Java 技术来构建的一个简单的学生选课系统，该网站建立在 SSM 框架上，前端使用 HTML 作为开发语言，后端使用 MySQL 数据库管理系统对数据进行管理，开发环境选用 IDEA，应用服务器采用 Tomcat8.5。

​		学生选课系统是高校教务系统一个非常重要的组成部分，是高校不可或缺的部分。相比于传统的手工选课选课方式麻烦，不易于更改，以及信息传达速度慢等缺点，网上选课系统不仅避免了学生过多无法进行人公选课的问题，也帮助教师及时了解学生的构成以及学生的兴趣爱好，方便教师和学生之间相互了解，另一方面也增加了学生选课自主权，使选课管理工作规范化、系统化、程序化，能够准确、及时、有效的查询和修改学生选课情况。

​		接下来将分为三个章节，第一部分为相关技术简介，主要介绍了 SSM 框架、IDEA、Tomcat 以及 MySQL 数据库等。

​		第二部分为需求分析，主要进行了系统的功能需求分析和非功能需求分析等。

​		第三部分为系统设计，对系统设计过程以及系统的详细设计实现进行了介绍。

### 五、基本技术方案

#### 1、HTML简介

​		HTML（HyperText Markup Language，超文本标记语言）是一种描述语言，用来定义网页结构，就其核心而言，HTML 是一种相当简单的、由不同元素组成的用来告知浏览器如何组织页面标记语言，一个完整的 HTML 页面通常包括以下几个部分：

```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Document</title>
</head>
<body>
    ...
</body>
</html>
```

​		其中，<!DOCTYPE html> 声明为 HTML5 文档，<html> 元素是 HTML 页面的根元素，<head> 元素包含了文档的 meta 数据，如 <meta charset="utf-8"> 定义网页编码格式为 UTF-8，<title> 元素描述了文档的标题，<body> 元素包含了可见的页面内容。

​		HTML的主要特点有以下几个

- 简易性：超文本标记语言版本升级采用超集方式，从而更加灵活方便。
- 可扩展性：超文本标记语言的广泛应用带来了加强功能，增加标识符等要求，超文本标记语言采取子类元素的方式，为系统扩展带来保证。
- 平台无关性：虽然个人计算机大行其道，但使用MAC等其他机器的大有人在，超文本标记语言可以使用在广泛的平台上，这也是万维网（WWW）盛行的另一个原因。
- 通用性：另外，HTML是网络的通用语言，一种简单、通用的全置标记语言。它允许网页制作人建立文本与图片相结合的复杂页面，这些页面可以被网上任何其他人浏览到，无论使用的是什么类型的电脑或浏览器。

#### 2、IDEA 简介

​		IDEA全称 IntelliJ IDEA，是 java 编程语言的集成开发环境。IntelliJ 在业界被公认为最好的 Java 开发工具，尤其在智能代码助手、代码自动提示、重构、JavaEE支持、各类版本工具(git、svn等)、JUnit、CVS整合、代码分析、 创新的GUI设计等方面的功能可以说是超常的。

​		IDEA 作为相对较新的 Java IDE，在项目的细节处理上做的十分完善：

- 本地历史：自动跟踪源代码中的每一个改变，精确到哪个文件在哪个时间做出了代码的改变，并能进行新旧两个文件在这次改动中的差异对比。
- 与文件系统自动同步：Idea 在这一点上做的很好。大多数工程都可以在Idea 里不用改变他们的结构就可以使用。Idea 还可以检查文件在外部的更改情况。这不需要人工刷新以告诉Idea 一个文件已被更改。
- 灵巧的模板：IDEA 提供创建新文件时自定义模板，比如各种 xml 配置文件、HTML初始界面等，提供了很大的便利。
- 强大的代码助手：IDEA 提供产生冗余代码和等价特性。如在类的定义中，提供生成 Getters/Setters、有参构造、无参构造以及重写 toString() 方法等；此外，提供了强大的代码补全以及引入局部变量功能，极大地节省了程序员写重复代码的时间。
- 灵活的 JUnit  支持：单元测试可以独立运行。特殊的测试方法可以单独拉出来独立运行。Idea 能够在一个包或者工程里自动运行所有测试而不需要手工启动一个麻烦的测试套件。在GUI 运行器里的堆迹线上双击可以直接切换到源代码的相应行。就我个人认为我更喜欢文本运行器。它不但秀美而且速度更快功能更多。

#### 3、MyBatis 简介

##### 3.1 MyBatis定义

​		MyBatis 是一款优秀的持久层框架，它支持自定义 SQL、存储过程以及高级映射。MyBatis 免除了几乎所有的 JDBC 代码以及设置参数和获取结果集的工作。MyBatis 可以通过简单的 XML 或注解来配置和映射原始类型、接口和 Java POJO（Plain Old Java Objects，普通老式 Java 对象）为数据库中的记录。MyBatis 有以下几点特性:

- 定制化SQL：即可以自己手写SQL语句。
- 支持存储过程
- 支持高级映射：即POJO和数据库字段的映射方式可以自定义。
- 封装了JDBC代码，和结果集的处理过程 → 不用手写JDBC代码和结果集处理的过程。

​		相比于传统的复杂的 JDBC，MyBatis 在 xml 文件中编写 SQL 语句，更加轻量，性能更加出色，而且使 SQL 和 Java 编码分开，功能边界清晰。Java 代码专注业务，SQL 语句专注数据。

##### 3.2 逆向工程

正向工程：先创建 Java 实体类，由框架负责根据实体类生成数据库表。

逆向工程：先创建数据库表，由框架负责根据数据库表，反向生成如下资源：

- Java 实体类
- Mapper 接口
- Mapper 映射文件

#### 4、Spring 简介

Spring是一个轻量级的控制反转(IOC)和面向切面编程(AOP)的开源框架。

##### 4.1 为什么是 Spring

- 方便解耦，简化开发：通过 Spring 提供的 IOC 容器，我们可以将对象之间的依赖关系交由Spring进行控制，避免硬编码所造成的过度程序耦合。有了Spring，用户不必再为单实例模式类、属性文件解析等这些很底层的需求编写代码，可以更专注于上层的应用。

- AOP编程的支持：通过Spring提供的AOP功能，方便进行面向切面的编程，许多不容易用传统OOP实现的功能可以通过AOP轻松应付。

- 声明式事务的支持：在Spring中，我们可以从单调烦闷的事务管理代码中解脱出来，通过声明式方式灵活地进行事务的管理，提高开发效率和质量。


##### 4.2 IOC

​	IOC (Inversion of Controller 反转控制)，反转控制的思想完全颠覆了应用程序组件获取资源的传统方式：反转了资源的获取方向 —— 改由容器主动的将资源推送给需要的组件，开发人员不需要知道容器是如何创建资源对象的，只需要提供接收资源的方向即可，极大的降低了学习成本，提高了开发效率。

​	DI(Dependency Injection 依赖注入)是对 IOC 的一种具体实现，即组件以一些预定义好的方式(例如 setter 方法) 接受来自于容器的资源注入。

##### 4.3 AOP

​		AOP(Aspect Oriented Programming) 是一种设计思想，是软件设计领域中的面向切面编程，它是面向对象编程的一种补充和完善，它以通过预编译方式和运行期动态代理方式实现在不修改源代码的情况下给程序动态统一添加额外功能的一种技术

- 简化代码：把方法中固定位置的重复的代码抽取出来，让被抽取的方法更专注于自己的核心功能，提高内聚性。
- 代码增强：把特定功能封装到切面类中，看哪里有需要，就往上套，被套用了切面逻辑的方法就被切面给增强了

##### 4.4 声明式事务

​		声明式事务是 Spring 提供的对程序事务管理的方式之一，采用声明的方式来处理事务，将固定模式的代码抽取出来，进行相关的封装，封装起来后，通过在配置文件中进行简单的配置来完成所需要的操作。

- 提高开发效率。
- 消除冗余代码。
- 框架综合考虑相关领域在实际开发环境下有可能遇到的各种问题，进行健壮性、性能等各方面的优化。

#### 5、SpringMVC

##### 5.1 什么是 MVC

​		MVC是一种软件架构的思想，将软件按照模型、视图、控制器来划分

​		M：Model，模型层，指工程中的 JavaBean，作用是处理数据，JavaBean 分为两类，一类是实体类Bean，专门存储业务数据的，如Student，Teacher等；一类是业务处理Bean，指 Service 或者 DAO 对象，专门处理业务逻辑和数据访问。

​		V：View，视图层，指工程中的 html 或 jsp 等页面，作用是与用户进行交互，展示数据。

​		C：Controller，控制层，指工程中的 Servlet，作用是接受请求和响应浏览器

##### 5.2 MVC的工作流程

​		用户通过视图层发送请求到服务器，在服务器中请求被 Controller 接收，Controller 再根据请求处理的结果找到相应的  View 视图，渲染数据后最终响应给浏览器。

##### 5.3 SpringMVC

- 基于原生Servlet，通过了功能强大的前端控制器 DispatcherServlet 来进行请求的统一管理。
- 内部组件化程度高、可插拔式组件即插即用，想要什么功能配置相应组件即可。
- 代码清新简洁，性能卓著

### 六、需求分析

#### 1、功能需求

本系统所需要的功能如下

##### 1.1 系统用户有三类组成：管理员、学生和教师

##### 1.2 系统管理员

1) 维护学生的个人基本信息，实现对学生个人信息的增删改查，学生信息包括学号、姓名、性别、年龄、专业、班级。
2) 维护教师的个人基本信息，实现对教师个人信息的增删改查，学生信息包括工号、姓名、性别、年龄、院系、薪水。
3) 维护课程的基本信息，实现对课程信息的增删改查，课程信息包括课程号、课程名、先修课、学分。

##### 1.3 学生用户：

1) 查询个人信息，以及所选课程的信息。
2) 进行选课操作。

##### 1.4 教师用户：

1) 查询个人信息，以及所教授课程的信息。
2) 添加授课信息。

#### 2、数据需求

本系统所需要的数据需求如下

1) 学生信息表(学号、姓名、性别、年龄、专业、班级)
2) 教师信息表(工号、姓名、性别、年龄、院系、薪水)
3) 课程信息表(课程号、课程名、先修课、学分)
4) 选课信息表(学号、课程号、成绩)
5) 授课信息表(工号、课程号)
6) 用户信息表(用户名、密码、用户类型)

#### 3、各部分实体属性图

1) ##### 学生信息表

<img src="C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221112163425515.png" alt="image-20221112163425515" style="zoom:80%;" />

2) ##### 教师信息表

   <img src="C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221112163620105.png" alt="image-20221112163620105" style="zoom:80%;" />

3) ##### 课程信息表

   <img src="C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221112163702083.png" alt="image-20221112163702083" style="zoom:80%;" />

4) ##### 选课信息表

   <img src="C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221112163746336.png" alt="image-20221112163746336" style="zoom:80%;" />

5) ##### 授课信息表

   <img src="C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221112163829252.png" alt="image-20221112163829252" style="zoom:80%;" />

6) ##### 用户信息表

   <img src="C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221112163930997.png" alt="image-20221112163930997" style="zoom:80%;" />

#### 4、系统ER图

![image-20221112165933112](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221112165933112.png)

### 七、系统设计概述

#### 1、数据库设计

本系统基于 MYSQL 实现关系模式，数据库建立如下：

![image-20221112170700929](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221112170700929.png)

将上述 E-R 模型中的各类实体转换为物理表，得到物理表结构部分如下：

1) ##### 学生信息表Student

   ![image-20221112170747901](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221112170747901.png)

   自上到下依次代表学号、姓名、性别、年龄、专业、班级。

2) ##### 教师信息表

   ![image-20221112170939828](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221112170939828.png)

   自上到下依次代表工号、姓名、性别、年龄、院系、薪水。

3) ##### 课程信息表

   ![image-20221112171433446](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221112171433446.png)

   自上到下依次代表课程号、课程名、先修课的课程号、学分。

4) ##### 选课信息表

   ![image-20221112171531243](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221112171531243.png)

   自上到下依次代表学号、课程号、成绩。

5) ##### 授课信息表

   ![image-20221112171600019](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221112171600019.png)

   自上到下依次代表工号、课程号。

6) ##### 用户信息表

   ![image-20221112171702064](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221112171702064.png)

   自上到下依次代表用户名、密码、用户类型。

#### 2、系统前端设计

​		系统的界面按照常规的 WEB 界面进行设计，设计的原则是界面友好、易于操作、容易上手，尽可能贴切用户实际。

​		系统的主界面兼登陆界面如下图所示：

![image-20221112174154376](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221112174154376.png)

​		进入系统后，按照用户类型的不同呈现不同的操作页面。

​		管理员主页如下图所示：

![image-20221112175612264](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221112175612264.png)

​		学生管理界面如下图所示：

![image-20221112212415241](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221112212415241.png)

​		教师管理界面如下图所示：

![image-20221112225058095](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221112225058095.png)

​		课程管理界面如下图所示

![image-20221112225041094](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221112225041094.png)

​		学生登录后，主界面如下：

![image-20221112225354751](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221112225354751.png)

​		学生个人信息界面如下：

![image-20221112231430662](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221112231430662.png)

​		修改密码界面如下：

![image-20221113095311642](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221113095311642.png)

​		修改成功后，点击确定跳转至登录界面重新登录，成功界面如下：

![image-20221113095531621](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221113095531621.png)		

学生选课界面如下：

![image-20221113100559692](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221113100559692.png)

​		可以输入学号实现精准搜索，也可以输入部分或完整课程名实现模糊搜获。搜索结果如下：

![image-20221113100817645](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221113100817645.png)

​		教师登录后，主界面如下：

![image-20221113101054277](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221113101054277.png)

​		教师个人信息界面如下：

![image-20221113102415379](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221113102415379.png)

​		修改界面和学生相同：

![image-20221113102952661](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221113102952661.png)

​	教师添加授课界面如下：

![image-20221113104618499](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221113104618499.png)

![image-20221113104644056](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221113104644056.png)

### 八、系统的详细配置

#### 1、创建表并插入数据

#### 2、配置 pom.xml

​		在 pom.xml 中，通过 dependencies 导入 SSM 开发所需要的包，通过 plugins 导入逆向工程需要的插件。

​		在导入相关依赖时，要针对自己具体的版本而使用，并不是最新的就是最好的，适合自己的才是最好的。比如我的 jdk 版本是1.8，tomcat 版本是 8.5，在刷新依赖时把所有依赖项都升级到最新版本，出现了 log4j 日志错误、浏览器页面找不到等情况。解决办法是确定好自己的版本后，bing 一下对应的插件版本。

#### 3、配置 jdbc.propertites

​		在这个文件中，配置属性来连接 MySQL 数据库。

```
jdbc.driver=com.mysql.cj.jdbc.Driver
jdbc.url=jdbc:mysql://localhost:3306/stu_select_course_sys?useSSL=false&serverTimezone=UTC
jdbc.username=root
jdbc.password=
```

#### 4、配置逆向工程生成文件 generatorConfig.xml

​		在这个文件中，主要配置以下几个部分的内容：数据库的连接信息，JavaBean 的生成策略，SQL 映射文件的生成策略，Mapper 接口的生成策略以及需要逆向分析的表以及指定各个表生成出来的实体类的类名。

#### 5、生成逆向工程

​		在 IDEA 右侧 maven下插件列表中找到如下插件，运行后成功生成 Java实体类、Mapper 接口和Mapper 映射文件。

![image-20221114153647655](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221114153647655.png)

![image-20221114153706690](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221114153706690.png)

​		通过逆向工程生成的实体类中多出来 Example 的实体类，Mapper 接口中也多出来通过 Example 类进行操作的函数。

![image-20221114153947523](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221114153947523.png)

​		MyBatis 的逆向工程中会生成实例及实例对应的 example，example 用于添加条件，相当  where 后面的部分，主要的条件又如下几个：

![image-20221114154222771](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221114154222771.png)

​		通过使用这些条件，可以通过简单调用来实现更复杂的 SQL 语句，十分方便。

#### 6、配置 mybatis-config.xml

![image-20221114193727167](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221114193727167.png)

![image-20221114193812916](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221114193812916.png)

​		设置分页插件，提供列表分页展示。

#### 7、配置 web.xml

​		在 web.xml 中，需要依次配置如下内容：

- 配置 Spring 的编码过滤器，设置自定义编码处理请求和响应的编码

```
<filter>
    <filter-name>CharacterEncodingFilter</filter-name>
    <filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class>
    <init-param>
        <param-name>encoding</param-name>
        <param-value>UTF-8</param-value>
    </init-param>
    <init-param>
        <param-name>forceEncoding</param-name>
        <param-value>true</param-value>
    </init-param>
</filter>
<filter-mapping>
    <filter-name>CharacterEncodingFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>
```

- 配置处理请求方式 PUT 和 DELETE 的过滤器

```
<filter>
    <filter-name>HiddenHttpMethodFilter</filter-name>
    <filter-class>org.springframework.web.filter.HiddenHttpMethodFilter</filter-class>
</filter>
<filter-mapping>
    <filter-name>HiddenHttpMethodFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>
```

- 配置 SpringMVC 的前端控制器

```
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>classpath:spring.xml</param-value>
</context-param>
```

- 配置Spring的监听器

```
<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>
```

#### 8、配置SpringMVC.xml

​		在 SpringMVC 配置文件中，需要配置以下几个部分内容：

- 扫描控制层组件

```
<context:component-scan base-package="com.system.controller"/>
```

- 配置视图解析器

```
<bean id="viewResolver" class="org.thymeleaf.spring5.view.ThymeleafViewResolver">
	<property name="order" value="1"/>
    <property name="characterEncoding" value="UTF-8"/>
    <property name="templateEngine">
    	<bean class="org.thymeleaf.spring5.SpringTemplateEngine">
        	<property name="templateResolver">
            	<bean class="org.thymeleaf.spring5.templateresolver.SpringResourceTemplateResolver">
                	<!-- 视图前缀 -->
                    <property name="prefix" value="/WEB-INF/templates/"/>
                    <!-- 视图后缀 -->
                    <property name="suffix" value=".html"/>
                    <property name="templateMode" value="HTML5"/>
                    <property name="characterEncoding" value="UTF-8"/>
                </bean>
            </property>
        </bean>
    </property>
</bean>
```

- 配置默认的 servlet 处理静态资源

```
<mvc:default-servlet-handler/>
```

- 开启 MVC 的注解驱动

```
<mvc:annotation-driven/>
```

- 配置访问首页的视图控制

```
<bean id="multipartResolver" class="org.springframework.web.multipart.commons.CommonsMultipartResolver"/>
```

#### 9、配置 Spring.xml

​		配置分为三大部分：

​		1、扫描除了 Controller 层外的其他组件 

![image-20221114155549525](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221114155549525.png)

​		2、事务相关：事务管理器和事务注解驱动

![image-20221114155752594](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221114155752594.png)

![image-20221114155825368](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221114155825368.png)		3、MyBaits需要的配置：引入 jdbc.properties、druid 数据源、SqlSessionFactoryBean 注册到IOC、产生的mapper代理类注册到IOC → 即配置 MapperScannerConfigurer

![image-20221114155731988](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221114155731988.png)

![image-20221114155929630](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221114155929630.png)

![image-20221114155946027](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221114155946027.png)

#### 10、配置完成后的整体文件结构

![image-20221114160725689](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221114160725689.png)

​		java 文件夹下为 Controller 层(/controller)、Dao 层的实体类(/pojo)和 mapper 接口(/mapper)、Service 层(/service)，resources 文件夹下为各类配置文件以及 Dao 层的 mapper 映射文件，webapp 下为导入的静态资源(前端样式表 css 和背景图片 images)，以及 View 层的前端显示页面(WEB-INF)。

​		在实际操作过程中，页面发送请求给控制器，控制器调用业务层处理逻辑，业务层向持久层发送请求，持久层与数据库交互后将结果返回给业务层，业务层将处理逻辑发送给控制器，控制器再调用视图展现数据。

### 九、系统功能实现

#### 1、用户登录页面

##### 1.1 功能实现

​		所有学生、教师以及管理员都可通过此页面输入账号密码后进入教务管理系统。

​		当用户输入用户名和密码后，点击登录提交表单到控制层(loginController)，控制层接收传进来的参数(username 和 password)，调用业务层处理逻辑(SuserService)，在业务层中，向持久层(SuserMapper)发送请求，持久层与数据库交互后将结果返回给业务层，交互时，判断用户表(Suser)中是否存在该条用户记录，如果存在则对用户类型进行判断(0：admin，1：student，2：teacher)，然后根据用户类型的不同，返回到各自的界面。如果用户名不存在或者输入的密码不符合，则返回至一个错误界面。

```
@Controller
@SessionAttributes({"username", "Sno", "Tno"})
public class loginController {
    @Autowired
    private SuserService suserService;
    // 登录表单处理
    @RequestMapping(value = "/login", method = RequestMethod.POST)
    public String login(String username, String password, Model model) {
        System.out.println("用户登录："+ username + password);
        // 封装成一个 Suser 类
        Suser suser = new Suser(username, password, null);
        // 创造条件
        SuserExample example = new SuserExample();
        example.createCriteria().andUsernameEqualTo(username);
        Suser suser1 = suserService.GetUser(example);
        // 判断用户记录是否存在
        String correctPassWord = suser1.getPassword();
        if (correctPassWord.equals(password)) {
            System.out.println("登陆成功");
            // 判断用户类型
            int type = Integer.parseInt(suser1.getType());
            if (type == 0) {
                model.addAttribute("username", username);
                return "admin";
            }
            else if (type == 1) {
                model.addAttribute("Sno", username);
                return "student";
            }
            else {
                model.addAttribute("Tno", username);
                return "teacher";
            }
        }
        // 用户不存在或者密码输入错误
        if (suser1.getUsername() == null) {
            return "failed";
        }
        return "failed";
    }
}
```

​		在项目实现中，我充分利用了 SSM 提供的各类注解：@Controller 是通过注解的方式表明这是一个控制层组件，这样通过 SpringMVC.xml 扫描到并使用该控制类；@SessionAttributes 注解提供了跨页传递参数的功能，通过这个注解，我将传进来的 username，Sno，Tno提供给其他页面使用；@Autowired 按类型自动装配成 bean；@RequestMapping 处理请求地址映射。

##### 1.2 界面展示

![image-20221114194338831](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221114194338831.png)

#### 2、学生列表展示

##### 2.1 功能实现

```
@RequestMapping(value = "/admin/student/page/{pageNum}", method = RequestMethod.GET)
public String getStudentPage(@PathVariable("pageNum") Integer pageNum, Model model) {
	// 获取分页信息
	PageInfo<Student> page = studentService.getStudentPage(pageNum);
	// 将分页数据共享到请求域中
	model.addAttribute("page", page);
	return "student_list";
}
```

​		控制层调用服务层函数，返回一个 PageInfo 对象，包含了当前分页的一些信息：

```
PageInfo{pageNum=1, pageSize=5, size=5, startRow=1, endRow=5, total=51, pages=11, list=Page{count=true, pageNum=1, pageSize=5, startRow=0, endRow=5, total=51, pages=11, reasonable=false, pageSizeZero=false}[查询到的信息], prePage=0, nextPage=2, isFirstPage=true, isLastPage=false, hasPreviousPage=false, hasNextPage=true, navigatePages=5, navigateFirstPage=1, navigateLastPage=5, navigatepageNums=[1, 2, 3, 4, 5]}
```

​		然后把这个分页信息传回到前端页面，就可以实现学生信息的分页展示。

​		在学生信息界面中，有返回主页、添加学生信息、查询学生信息，以及对每一条学生信息的修改和删除操作。

##### 2.2 界面展示

![image-20221115192831054](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115192831054.png)

#### 3、添加学生信息

##### 3.1 功能实现

​		在学生管理界面点击添加学生信息，进入到添加界面，需要输入学生的详细信息。

![image-20221115194529474](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115194529474.png)

​		通过前端的 form 表单提交到控制层(adminController)。

![image-20221115194614095](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115194614095.png)

​		然后调用 service层的添加函数，最后重定向至学生列表界面。

##### 3.2 界面展示

![image-20221115194402062](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115194402062.png)

#### 4、查询学生信息

##### 4.1 功能实现

​		在学生管理界面点击查询学生信息后，跳转至查询界面，输入查询信息时，可以输入学号实现精确查询，也可以输入部分信息实现模糊查询。点击查询后，通过 form 表单将查询信息转交给控制层。

​		在实现这个功能时，因为要查询一个分页信息，于是我进行了中转。

![image-20221115195649030](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115195649030.png)

​		首先将查询的信息打包成一个 Student 类来作为查询条件，并通过 Model 提供的 addAttribute 函数将打包好的类传到前端页面，然后重定向至另外一个域。

![image-20221115195630905](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115195630905.png)

​		在这个域中，首先接收中转界面床过来的代表查询条件的 Student 对象，然后调用服务层的根据条件和页码来查询分页信息的函数，将查询结果返回到前端界面来展示查询结果。

##### 4.2 界面展示

![image-20221115200051622](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115200051622.png)

​		在这里展示查询年龄为 18 的性别不限的学生，其他的都可以进行模糊查询，如果没有任何输入点击提交，则返回整个学生列表，否则按照输入的部分信息进行模糊查询。

![image-20221115200506698](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115200506698.png)

#### 5、修改学生信息

##### 5.1 功能实现

​		在学生信息界面点击右侧的修改进入到修改学生信息界面，因为学号是无法修改的，因此在输入时学号作为确定项展示出来，类似查询，输入剩下的部分或全部信息来实现修改。

![image-20221115203146441](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115203146441.png)

​		修改时，如果输入的信息为空，则保持原来的值不变，只修改存在输入值的属性。将前端传进来的参数打包成一个对象，穿个服务层。

![image-20221115202340254](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115202340254.png)

​		服务层调用通过逆向工程生成的 mapper 接口来和数据库进行交互，按条件修改学生信息，修改完成后返回至学生列表。

##### 5.2 界面展示

![image-20221115201719395](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115201719395.png)

![image-20221115201740699](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115201740699.png)

![image-20221115201826879](C:\Users\来来来\Desktop\image-20221115201826879.png)

#### 6、删除学生信息

##### 6.1 功能实现

​		在学生信息页面点击删除学生后，将学生学号传给控制层，在控制层调用服务层提供的删除函数，将该条信息从数据库中删除，然后返回到学生列表。

![image-20221115204905818](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115204905818.png)

##### 6.2 页面展示

![image-20221115204840117](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115204840117.png)

![image-20221115204855753](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115204855753.png)

#### 7、管理员模式下教师管理和课程管理

​		依照学生信息管理的实现方法，实现教师管理和课程管理。

#### 8、学生个人信息展示

##### 8.1 功能实现

​		在登录界面时，如果输入的用户名和密码经过判断后确定用户类型为学生，则进入到学生主页。点击个人信息后，进入到个人信息展示页面。

​		跳转时，将学生学号由前端传给控制层(studengController)，然后控制层调用服务层的函数，从学生表当中查询到个人信息，从选课表当中查出个人选课记录，一起传送给前端页面进行展示。

![image-20221115205650872](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115205650872.png)

​		这里要说明一下，我的选课表(SC)在设计时只包含了三个属性：学号、课程号和课程信息，其中学号和课程号是外键，分别对应于学生表的学号和课程表的课程号，因此查询出来的课程信息只有课程号和成绩而没有课程名、先修课以及学分信息，因此需要做查询结果和课程表的拼接。

![image-20221115205903304](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115205903304.png)

​		于是我手动创建了一个类为 SC_Course。

![image-20221115205944784](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115205944784.png)

​		这个类包含课程号、成绩、课程名、先修课和学分。

![image-20221115210038501](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115210038501.png)

​		之后我通过一个二重循环，外循环遍历查询到的选课信息、内循环遍历课程信息，如果两个课程名相同，则拼接到一起，将结果插入到列表当中，最后把列表转发给前端页面进行展示。

##### 8.2 界面展示

![image-20221115205322605](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115205322605.png)

![image-20221115205349507](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115205349507.png)

#### 9、学生修改密码

##### 9.1 功能实现

​		学生登入后，点击修改密码跳转到修改密码界面，按照提示输入两次密码后，对新旧密码进行判断。

![image-20221115221534957](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115221534957.png)

​		如果二者相同且均不为空，则调用服务层的函数在数据库中修改相关数据，并跳出弹窗提示“修改成功，请重新登录！”，点击确定后返回登录界面；如果两次输入的密码不一致或者有一个为空则提示错误并返回修改密码界面重新输入。

##### 9.2 界面展示

![image-20221115215408156](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115215408156.png)

![image-20221115215353723](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115215353723.png)

![image-20221115215029788](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115215029788.png)

![image-20221115221605762](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115221605762.png)

#### 10、学生选课功能实现

##### 10.1 功能实现

​		在学生主页点击学生选课后进入到选课界面，可以输入课程号实现精准查询，也可以输入部分或全部课程名实现模糊查询。

![image-20221115222251091](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115222251091.png)

​		将查询结果返回到一个课程界面展示，并在课程信息列表后面设置选课按钮，点击选课后，在选课表中添加该条记录，将成绩设置为空，并返回至学生信息界面。

![image-20221115222451680](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115222451680.png)

##### 10.2 界面展示

![image-20221115222333630](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115222333630.png)

![image-20221115222550020](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115222550020.png)

![image-20221115222535228](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115222535228.png)

![image-20221115222617377](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115222617377.png)

#### 11、教师相关功能的实现

​		与学生功能相似，完成教师的有关功能。

### 十、系统存在的缺点以及期末要改正的方向

#### 1、数据库设计的缺点

​		首先为了图方便，采用的是这学期数据库系统这门课中经常使用的学生-选课数据库，采用了书上提供的属性，但是在实验过程当中，切身体会到了理论知识和实际开发当中确实存在着很大的差别，书本上的理论知识终究只是书本上的理论知识，如果不亲身实践，是不会知道很多细节方面的内容。其中最大的感触是外键这块内容。在学习过程中，外键被作为重点内容联系了很多次，在项目数据库设计过程中，我也使用到了外键，如选课表里的学号和课程号以及教师授课表里的工号和课程号，当我在做插入、修改等操作时，经常出现数据库报错：提示外键存在不允许操作的进行，后来通过查阅资料了解到，在工作实际开发中，的确要求尽量避免甚至不允许使用外键。

![image-20221115212317377](C:\Users\来来来\AppData\Roaming\Typora\typora-user-images\image-20221115212317377.png)

​		因此接下来我将采用增加冗余表或者查找其他办法来代替外键，比如这次我使用的 SC_Course 表。

​		其次，在数据库各张表的属性设计中也不太完善，比如课程表中没有上课时间，没有增加院系表等等。

#### 2、功能上的不足

- 课程信息中没有上课时间，没有区分专业课、通识课以及必修选修等。
- 目前是学生自主选课、教师自主授课，没有管理员的介入，应该增设管理员批准的中间环节。
- 管理员不能批量添加、删除、修改三个表的信息，只能一个一个进行操作，这与实际不符。
- 学生选课时不能查看所有未修课程来选课，应该在选课界面增设菜单，第一个是查看所有选课记录获得课程号。这里提供按照课程名检索课程信息，然后在第二个选课界面通过输入课程号选课。
- 学生只能选课不能退课。
- 选课时没有设置学生上限等选课细节。
- 学生界面和教师界面没有类似管理员界面一样的返回主页的功能，只能依靠浏览器的后退键返回。
- 查询、增加、修改没有取消操作的功能。
- 不能实现表的下载，如学生不能导出课程表和成绩表，教师不能导出上课学生名单。

### 十一、项目总结与体会

​		这次期中项目是对 SSM 框架的简单实现，完成了学生、课程、教师三张表的增删改查，以及简单地实现了学生选课、教师授课的过程，收获很多。

​		在这次项目中，我我主要使用了 MyBatis 提供的逆向工程，以及 SSM 提供的注解注入功能来完成各项功能，目前存在的问题是对于界面之间的请求、跳转还不是太理解，以及前端设计的不足，没有很好地美化界面，提供的操作也十分简单，没有用到较高级的 JavaScript 等内容。

​		接下来要和组员一起重新设计数据库，分工完成各项功能，尽最大的努力再现一个 jwgl.ouc.edu.cn。

​		在课程学习上，我希望能以项目驱动，可以以一个完整的实际开发的项目为例，讲解实现细节的同时穿插讲解知识。对于课上传递的许多前沿知识，我基本都没有听说过，需要尽快确定自己未来的发展方向做深入学习。
